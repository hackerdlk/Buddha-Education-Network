import{r as m,j as e,u as h,a as u,L as d}from"./index-B1926wCP.js";import{u as b}from"./useData-BdLoSvGT.js";function p({videoUrl:a,title:l,onBack:c}){const n=m.useRef(null),[o,i]=m.useState(null),[r,t]=m.useState(!0);m.useEffect(()=>{i(null),t(!0)},[a]);const s=()=>{t(!1)},x=()=>{i("è§†é¢‘åŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿žæŽ¥æˆ–è§†é¢‘é“¾æŽ¥æ˜¯å¦æœ‰æ•ˆ"),t(!1)};return e.jsxs("div",{className:"bg-black rounded-lg overflow-hidden shadow-2xl",children:[e.jsxs("div",{className:"bg-gray-900 text-white px-6 py-3 flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold truncate",children:l}),c&&e.jsx("button",{onClick:c,className:"ml-4 px-4 py-1 bg-gray-700 hover:bg-gray-600 rounded transition-colors text-sm",children:"è¿”å›ž"})]}),e.jsxs("div",{className:"relative bg-black",style:{paddingTop:"56.25%"},children:[r&&!o&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-white mx-auto mb-4"}),e.jsx("p",{className:"text-white",children:"åŠ è½½ä¸­..."})]})}),o?e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center px-4",children:[e.jsx("div",{className:"text-red-500 text-5xl mb-4",children:"âš ï¸"}),e.jsx("p",{className:"text-white font-semibold mb-2",children:"è§†é¢‘åŠ è½½å¤±è´¥"}),e.jsx("p",{className:"text-gray-300 text-sm",children:o}),e.jsx("button",{onClick:()=>{i(null),t(!0),n.current&&n.current.load()},className:"mt-4 px-6 py-2 bg-primary hover:bg-secondary text-white rounded-lg transition-colors",children:"é‡è¯•"})]})}):e.jsx("video",{ref:n,className:"absolute inset-0 w-full h-full",controls:!0,controlsList:"nodownload",onLoadedData:s,onError:x,src:a,children:"æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾"})]}),e.jsx("div",{className:"bg-gray-900 text-gray-400 px-6 py-3 text-sm",children:e.jsx("p",{children:"ðŸ’¡ æç¤ºï¼šç‚¹å‡»æ’­æ”¾å™¨å³ä¸‹è§’å¯å…¨å±è§‚çœ‹"})})]})}function f(){const{courseId:a,episodeId:l}=h(),c=u(),{courses:n,loading:o,error:i}=b();if(o)return e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"åŠ è½½ä¸­..."})]})});if(i)return e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-red-500 text-4xl mb-3",children:"âš ï¸"}),e.jsx("p",{className:"text-red-700 font-semibold mb-2",children:"åŠ è½½å¤±è´¥"}),e.jsx("p",{className:"text-red-600 mb-4",children:i}),e.jsx(d,{to:"/courses",className:"inline-block px-6 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition-colors",children:"è¿”å›žè¯¾ç¨‹åˆ—è¡¨"})]});const r=n.find(s=>s.id===a),t=r==null?void 0:r.episodes.find(s=>s.id===l);return!r||!t?e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 text-center",children:[e.jsx("div",{className:"text-yellow-500 text-4xl mb-3",children:"ðŸ“­"}),e.jsx("p",{className:"text-yellow-700 font-semibold mb-2",children:"æœªæ‰¾åˆ°è§†é¢‘"}),e.jsx("p",{className:"text-yellow-600 mb-4",children:"è¯·æ£€æŸ¥é“¾æŽ¥æ˜¯å¦æ­£ç¡®"}),e.jsx(d,{to:"/courses",className:"inline-block px-6 py-2 bg-primary text-white rounded-lg hover:bg-secondary transition-colors",children:"è¿”å›žè¯¾ç¨‹åˆ—è¡¨"})]}):e.jsxs("div",{className:"max-w-7xl mx-auto w-full",children:[e.jsxs("div",{className:"mb-4 sm:mb-5 text-sm sm:text-base md:text-lg text-gray-600 flex flex-wrap items-center gap-1.5",children:[e.jsx(d,{to:"/",className:"hover:text-primary transition-colors font-medium",children:"é¦–é¡µ"}),e.jsx("span",{className:"text-gray-400",children:"/"}),e.jsx(d,{to:"/courses",className:"hover:text-primary transition-colors font-medium",children:"å½±éŸ³è®²å ‚"}),e.jsx("span",{className:"text-gray-400",children:"/"}),e.jsx(d,{to:`/courses/${a}`,className:"hover:text-primary transition-colors font-medium",children:r.name}),e.jsx("span",{className:"text-gray-400",children:"/"}),e.jsx("span",{className:"text-gray-800 font-semibold",children:t.title})]}),e.jsx("div",{className:"mb-4 sm:mb-6",children:e.jsx(p,{videoUrl:t.videoUrl,title:t.title,onBack:()=>c(`/courses/${a}`)})}),r.episodes.length>1&&e.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-md sm:shadow-lg border border-secondary/20 overflow-hidden",children:[e.jsx("div",{className:"p-4 sm:p-5 border-b border-gray-200 bg-warm/30",children:e.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-primary flex items-center",children:[e.jsx("span",{className:"w-1 h-6 sm:h-7 bg-secondary rounded-full mr-2 sm:mr-3"}),"é€‰é›† (",r.episodes.length,"é›†)"]})}),e.jsx("div",{className:"overflow-y-auto max-h-64 sm:max-h-80 md:max-h-96",children:e.jsx("div",{className:"divide-y divide-gray-200",children:r.episodes.map((s,x)=>e.jsxs(d,{to:`/player/${a}/${s.id}`,className:`flex items-center gap-3 sm:gap-4 p-3 sm:p-4 transition-all group ${s.id===l?"bg-secondary/10 border-l-4 border-secondary":"hover:bg-warm/50 border-l-4 border-transparent"}`,children:[e.jsx("div",{className:`flex-shrink-0 w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center text-white font-bold text-sm sm:text-base shadow-md transition-all ${s.id===l?"bg-gradient-to-br from-secondary to-accent shadow-lg scale-110":"bg-gradient-to-br from-primary to-accent group-hover:scale-110"}`,children:x+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:`text-sm sm:text-base font-semibold transition-colors line-clamp-1 ${s.id===l?"text-primary":"text-gray-800 group-hover:text-primary"}`,children:s.title}),s.duration&&e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500 mt-0.5 sm:mt-1",children:["æ—¶é•¿: ",s.duration]})]}),e.jsx("div",{className:"flex-shrink-0",children:s.id===l?e.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 px-2 sm:px-3 py-1 sm:py-1.5 bg-secondary text-white text-xs sm:text-sm font-bold rounded-full shadow-md",children:[e.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})}),"æ’­æ”¾ä¸­"]}):e.jsx("div",{className:"text-primary group-hover:text-secondary transition-colors",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M8 5v14l11-7z"})})})})]},s.id))})})]})]})}export{f as Player};
